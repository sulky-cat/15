(()=>{"use strict";let t=!0,e=(t=500)=>{document.documentElement.classList.contains("lock")?s(t):o(t)},s=(e=500)=>{let s=document.querySelector("body");if(t){let o=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let t=0;t<o.length;t++){o[t].style.paddingRight=""}s.style.paddingRight="",document.documentElement.classList.remove("lock")}),e),t=!1,setTimeout((function(){t=!0}),e)}},o=(e=500)=>{let s=document.querySelector("body");if(t){let o=document.querySelectorAll("[data-lp]");for(let t=0;t<o.length;t++){o[t].style.paddingRight=window.innerWidth-document.body.offsetWidth+"px"}s.style.paddingRight=window.innerWidth-document.body.offsetWidth+"px",document.documentElement.classList.add("lock"),t=!1,setTimeout((function(){t=!0}),e)}};function n(){s(),document.documentElement.classList.remove("menu-open")}const i=new class{constructor(t){let e={attributeOpenButton:"data-popup",attributeCloseButton:"data-close",youtubeAttribute:"data-youtube",youtubePlaceAttribute:"data-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"popup__content",popupActive:"popup_show",bodyActive:"popup-show"},focusCatch:!0,closeEsc:!0,bodyLock:!0,bodyLockDelay:500,hashSettings:{location:!0,goHash:!0},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.isOpen=!1,this.lockBeforeOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...e,...t,classes:{...e.classes,...t?.classes},hashSettings:{...e.hashSettings,...t?.hashSettings},on:{...e.on,...t?.on}},this.initPopups()}initPopups(){this.eventsPopup()}eventsPopup(){document.addEventListener("click",function(e){const s=e.target.closest(`[${this.options.attributeOpenButton}]`);if(s&&t)return e.preventDefault(),this._dataValue=s.getAttribute(this.options.attributeOpenButton)?s.getAttribute(this.options.attributeOpenButton):"error",this.youtubeCode=s.hasAttribute(this.options.youtubeAttribute)?s.getAttribute(this.options.youtubeAttribute):null,"error"!==this._dataValue?(this.isOpen||(this.lastFocusEl=s),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,void this.open()):void 0;return e.target.closest(`[${this.options.attributeCloseButton}]`)||!e.target.closest(`.${this.options.classes.popupContent}`)&&this.isOpen?(e.preventDefault(),void this.close()):void 0}.bind(this)),document.addEventListener("keydown",function(t){if(this.options.closeEsc&&27==t.which&&"Escape"===t.code&&this.isOpen)return t.preventDefault(),void this.close();this.options.focusCatch&&9==t.which&&this.isOpen&&this._focusCatch(t)}.bind(this)),document.querySelector("form[data-ajax],form[data-dev]")&&document.addEventListener("formSent",function(t){const e=t.detail.form.dataset.popupMessage;e&&this.open(e)}.bind(this)),this.options.hashSettings.goHash&&(console.log("location"),window.addEventListener("hashchange",function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}.bind(this)),window.addEventListener("load",function(){window.location.hash&&this._openToHash()}.bind(this)))}open(t){if(document.documentElement.classList.contains("lock")&&!this.isOpen&&(this.lockBeforeOpen=!0),t&&"string"==typeof t&&""!==t.trim()&&(this.targetOpen.selector=t,this._selectorOpen=!0),document.documentElement.classList.contains("lock")&&(this._reopen=!0,this.isOpen&&this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(this.targetOpen.selector),this.targetOpen.element){if(this.youtubeCode){const t=`https://www.youtube.com/embed/${this.youtubeCode}?rel=0&showinfo=0&autoplay=1`,e=document.createElement("iframe");e.setAttribute("allowfullscreen","");const s=this.options.setAutoplayYoutube?"autoplay;":"";e.setAttribute("allow",`${s}; encrypted-media`),e.setAttribute("src",t),this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(e)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),this.targetOpen.element.classList.add(this.options.classes.popupActive),document.body.classList.add(this.options.classes.bodyActive),this._reopen?this._reopen=!1:e(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout((()=>{this._focusTrap()}),50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}}))}}close(s){s&&"string"==typeof s&&""!==s.trim()&&(this.previousOpen.selector=s),this.isOpen&&t&&(this.options.on.beforeClose(this),this.youtubeCode&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&(this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""),this.previousOpen.element.classList.remove(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.body.classList.remove(this.options.classes.bodyActive),this.lockBeforeOpen||e(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout((()=>{this._focusTrap()}),50))}_getHash(){this.options.hashSettings.location&&(this.hash=this.targetOpen.selector.includes("#")?this.targetOpen.selector:this.targetOpen.selector.replace(".","#"))}_openToHash(){let t=document.querySelector(`.${window.location.hash.replace("#","")}`)?`.${window.location.hash.replace("#","")}`:document.querySelector(`${window.location.hash}`)?`${window.location.hash}`:null;const e=document.querySelector(`[${this.options.attributeOpenButton}="${t}"]`),s=document.querySelector(t);(e||s)&&t&&this.open(t)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(t){const e=this.targetOpen.element.querySelectorAll(this._focusEl),s=Array.prototype.slice.call(e),o=s.indexOf(document.activeElement);t.shiftKey&&0===o&&(s[s.length-1].focus(),t.preventDefault()),t.shiftKey||o!==s.length-1||(s[0].focus(),t.preventDefault())}_focusTrap(){const t=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():t[0].focus()}}({hashSettings:{location:!1}}),a=document.querySelector(".game");if(a){const c=a.querySelector(".game__body");let r,u=16,h=b(u),d=y(u,h[1]),p=null;if(localStorage.getItem("matrix")){const C=localStorage.getItem("matrix").split(",");u=C.length,h=b(u),d=y(u,C)}function m(t,e){const s=S(u,t);console.log("posNull && blockCoords",s,p);const o=g(s,t,p);_(o[Math.floor(Math.random()*o.length)],s,t,e),p=s}function g(t,e,s){const o=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)w([n,i],t)&&(console.log("blockedCoords",s,!s||!(s[0]===n&&s[1]===i),"y",n,"x",i),s&&s[0]===n&&s[1]===i||(s&&console.log(!(s[0]===n&&s[1]===i)),o.push([n,i])));return console.log("validCoords",o),o}function f(t,e){const s=document.createElement("div");s.classList.add("game__button"),s.setAttribute("data-game",t),s.setAttribute("type","button"),s.textContent=t;const o=100/Math.sqrt(e);return s.style.width=`${o}%`,s.style.height=`${o}%`,localStorage.getItem("type")&&l(localStorage.getItem("type")),s}function b(t){c.innerHTML="";for(let e=1;e<=t;e++){const s=f(e,t);c.insertAdjacentElement("beforeend",s)}const e=Array.from(c.children);e[e.length-1].style.display="none";let s=[];return e.map((t=>Number(s.push(t.dataset.game)))),[e,s]}function y(t,e){const s=Math.sqrt(t);let o=0,n=0,i=[],a=[];for(let t=0;t<=e.length;t++)n>=s&&(i[o]=a.slice(),o++,n=0),a[n]=e[t],n++;return i}function v(t,e){for(let s=0;s<t.length;s++)for(let o=0;o<t[s].length;o++){const n=t[s][o];O(e[0][n-1],s,o)}}function O(t,e,s){t.style.transform=`translate3D(${100*s}%,${100*e}%,0)`}function S(t,e){for(let s=0;s<e.length;s++)for(let o=0;o<e.length;o++)if(e[s][o]==t)return[s,o,t]}function w(t,e){if(e){const s=Math.abs(t[0]-e[0]),o=Math.abs(t[1]-e[1]);return!(0!==s&&0!==o||1!==s&&1!==o)}return!1}function _(t,e,s,o){if(w(t,e)){const n=t[0],i=t[1],a=e[0],l=e[1];let c=s[a][l];s[a][l]=s[n][i],s[n][i]=c,v(s,o);const r=document.querySelector(".game");L(s)?r.classList.add("won"):r.classList.remove("won"),localStorage.setItem("matrix",s)}}function E(t,e,s,o){const n=Math.sqrt(o);if(!1!==t&&!1!==e&&t<n&&e<n&&t>=0&&e>=0)return s[t][e]}function L(t){const e=t.flat(),s=A(e);for(let t=0;t<e.length;t++)if(e[t]!=s[t])return!1;return!0}function A(t){let e=[];for(let s=0;s<t.length;s++)e[s]=s+1;return e}v(d,h),a.addEventListener("click",(t=>{const e=t.target;if(e.closest("[data-create-buttons]")&&(u=e.dataset.createButtons,h=b(u),d=y(u,h[1]),setTimeout((()=>{v(d,h)}),50),localStorage.setItem("matrix",d)),e.closest(".game__start")){a.classList.remove("won");let t=0;clearInterval(r),a.classList.add("fast"),0===t&&(r=setInterval((()=>{m(d,h),t+=1,t>=100&&(clearInterval(r),a.classList.remove("fast"))}),40))}if(e.closest(".game__button")){_(S(e.dataset.game,d),S(u,d),d,h)}})),window.addEventListener("keydown",(t=>{const e=t.keyCode;if([37,38,39,40,65,87,68,83].includes(e)){const t=S(u,d);let s,o,n=!1;switch(e){case 37:case 65:s=t[0],o=t[1]+1,n=[s,o,E(s,o,d,u)];break;case 38:case 87:s=t[0]+1,o=t[1],n=[s,o,E(s,o,d,u)];break;case 39:case 68:s=t[0],o=t[1]-1,n=[s,o,E(s,o,d,u)];break;case 40:case 83:s=t[0]-1,o=t[1],n=[s,o,E(s,o,d,u)]}n[0]>=0&&n[1]>=0&&n[0]<d.length&&n[1]<d.length&&_(n,t,d,h)}27===t.keyCode&&document.documentElement.classList.contains("menu-open")&&n()}))}function l(t){document.querySelectorAll("[data-game]").forEach((e=>{e.style.borderRadius=`${t}%`}))}window.addEventListener("DOMContentLoaded",(()=>{const t=document.body;localStorage.getItem("visit")||(i.open("#start"),localStorage.setItem("visit",!0),localStorage.setItem("theme","dark"),localStorage.setItem("type","10"));s(localStorage.getItem("theme"),t),l(localStorage.getItem("type"));const e=document.querySelector(".settings");function s(t,e){switch(t){case"dark":e.classList.remove("theme-light"),e.classList.add("theme-dark"),localStorage.setItem("theme","dark");break;case"light":e.classList.remove("theme-dark"),e.classList.add("theme-light"),localStorage.setItem("theme","light")}}e&&e.addEventListener("click",(e=>{const o=e.target;if(o.closest("[data-theme]")){s(o.dataset.theme,t)}if(o.closest("[data-local]")&&(localStorage.clear(),document.location.reload()),o.closest("[data-type]")){const t=o.dataset.type;localStorage.setItem("type",t),l(t)}}))})),document.addEventListener("click",(t=>{const e=t.target;e.closest(".settings")||e.closest(".gear")||!document.documentElement.classList.contains("menu-open")||n()})),function(){let s=document.querySelector(".burger-btn,.gear");s&&s.addEventListener("click",(function(s){t&&(e(),document.documentElement.classList.toggle("menu-open"))}))}()})();